 <!DOCTYPE html>
<html lang="ar" dir="rtl" id="htmlElement">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>طلب شراء مروحة - شركة الرياح للتسوق الإلكتروني</title>
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --accent-color: #ff3e9d;
            --light-color: #f8f9fa;
            --dark-color: #2c3e50;
            --price-color: #2ecc71;
            --discount-color: #e74c3c;
            --footer-color: #34495e;
            --cash-color: #3498db;
            --en-color: #3498db;
            --ar-color: #e74c3c;
            --ku-color: #2ecc71;
            --customer-color: #9b59b6;
            --location-color: #f39c12;
        }
        
        body {
            font-family: 'Tajawal', 'Segoe UI', Arial, sans-serif;
            max-width: 650px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #BA55D3 100%);
            color: var(--dark-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .header::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path fill="rgba(255,255,255,0.1)" d="M0,0 L100,0 L100,100 L0,100 Z" /></svg>');
            opacity: 0.3;
        }
        
        .logo {
            max-width: 180px;
            margin-bottom: 10px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        .language-switcher {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: flex-start;
            padding-left: 15px;
        }
        
        .lang-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: none;
            background: white;
            color: var(--dark-color);
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
        
        .lang-btn:hover {
            transform: translateY(-3px);
        }
        
        .lang-btn.active {
            transform: scale(1.1);
            box-shadow: 0 0 0 3px white;
        }
        
        .lang-btn.ar { background: var(--ar-color); color: white; }
        .lang-btn.en { background: var(--en-color); color: white; }
        .lang-btn.ku { background: var(--ku-color); color: white; }
        
        .product-images {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            position: relative;
        }
        
        .product-images img {
            max-width: 250px;
            border-radius: 12px;
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
            border: 3px solid white;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .product-images img:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0,0,0,0.2);
        }
        
        .form-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            flex-grow: 1;
        }
        
        .form-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 8px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary-color), var(--secondary-color));
        }
        
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        h1::after {
            content: "";
            display: block;
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--accent-color), var(--secondary-color));
            margin: 10px auto;
            border-radius: 2px;
        }
        
        .company-name {
            color: white;
            text-align: center;
            font-size: 1.4em;
            margin-bottom: 5px;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .product-info {
            background: linear-gradient(135deg, #f6f9fc 0%, #e7eff8 100%);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .product-info p {
            margin: 8px 0;
            font-size: 16px;
        }
        
        .product-info strong {
            color: var(--primary-color);
        }
        
        .price-summary {
            margin-top: 25px;
            padding: 15px;
            background: linear-gradient(135deg, #f8fff9 0%, #e1f7e8 100%);
            border-radius: 10px;
            border: 2px solid var(--price-color);
            text-align: center;
        }
        
        .total-price {
            font-size: 24px;
            font-weight: bold;
            color: var(--price-color);
            margin: 10px 0;
        }
        
        .discount-notice {
            color: var(--discount-color);
            font-weight: bold;
            margin-top: 10px;
            font-size: 16px;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark-color);
            font-size: 16px;
        }
        
        input[type="text"],
        input[type="number"],
        input[type="tel"],
        textarea,
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
            transition: all 0.3s ease;
            background-color: #f8fafc;
        }
        
        input[type="text"]:focus,
        input[type="number"]:focus,
        input[type="tel"]:focus,
        textarea:focus,
        select:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.2);
            outline: none;
            background-color: white;
        }
        
        .address-group {
            position: relative;
        }
        
        .location-btn {
            position: absolute;
            top: 42px;
            left: 10px;
            background: var(--location-color);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .location-btn:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }
        
        .location-btn:active {
            transform: translateY(0);
        }
        
        .location-note {
            display: block;
            margin-top: 10px;
            padding: 10px;
            background: #fff8e6;
            border-radius: 8px;
            border-left: 4px solid var(--location-color);
            color: #7d6608;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        .location-note strong {
            color: var(--location-color);
        }
        
        .color-quantities {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .color-quantity {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            background-color: white;
            position: relative;
            overflow: hidden;
        }
        
        .color-preview {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-bottom: 10px;
            border: 2px solid #fff;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .color-name {
            font-weight: bold;
            font-size: 16px;
            color: var(--dark-color);
            margin-bottom: 10px;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .quantity-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .quantity-btn:hover {
            background: var(--secondary-color);
            transform: scale(1.1);
        }
        
        .quantity-btn:active {
            transform: scale(0.95);
        }
        
        .quantity-input {
            width: 50px;
            text-align: center;
            padding: 8px 5px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
        }
        
        .quantity-input:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        
        .submit-btn {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.3);
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .submit-btn:hover {
            background: linear-gradient(to right, #5a0cb0, #1a65e8);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(106, 17, 203, 0.4);
        }
        
        .submit-btn:active {
            transform: translateY(0);
        }
        
        .optional {
            color: #7e8ba3;
            font-style: italic;
            font-size: 0.9em;
        }
        
        .whatsapp-icon {
            width: 24px;
            height: 24px;
            filter: brightness(0) invert(1);
        }
        
        .phone-note {
            display: block;
            color: #666;
            font-size: 0.8em;
            margin-top: 5px;
            font-style: italic;
        }
        
        .footer {
            background-color: var(--footer-color);
            color: white;
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-top: auto;
        }
        
        .footer p {
            margin: 5px 0;
        }
        
        .company-name-footer {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .customer-message-note {
            display: block;
            margin-top: 10px;
            padding: 15px;
            background: linear-gradient(135deg, #f9f0ff 0%, #e8d6ff 100%);
            border-radius: 8px;
            border-left: 4px solid var(--customer-color);
            color: var(--dark-color);
            font-size: 0.95em;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .customer-message-note strong {
            color: var(--customer-color);
        }
        
        .payment-note {
            display: block;
            margin-top: 10px;
            padding: 15px;
            background: #f0f9ff;
            border-radius: 8px;
            border-left: 4px solid var(--cash-color);
            color: #2c3e50;
            font-size: 0.95em;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .payment-note strong {
            color: var(--cash-color);
        }
        
        .payment-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
        }
        
        .payment-icon {
            width: 24px;
            height: 24px;
        }
        
        .loading-indicator {
            display: none;
            text-align: center;
            padding: 10px;
            color: var(--location-color);
            font-weight: bold;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--location-color);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 600px) {
            body {
                padding: 15px;
            }
            
            .header {
                padding: 15px;
            }
            
            .form-container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .color-quantities {
                flex-direction: column;
            }
            
            .language-switcher {
                padding-left: 0;
                justify-content: center;
            }
            
            .location-btn {
                position: relative;
                top: 0;
                left: 0;
                width: 100%;
                margin-top: 10px;
                justify-content: center;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="header">
        <div class="company-name" data-translate="company_name">شركة الرياح للتسوق الإلكتروني</div>
    </div>
    
    <!-- أزرار اللغات في الجهة اليسرى لمنطقة الصور -->
    <div class="language-switcher">
        <button class="lang-btn ar active" onclick="changeLanguage('ar')">ع</button>
        <button class="lang-btn en" onclick="changeLanguage('en')">EN</button>
        <button class="lang-btn ku" onclick="changeLanguage('ku')">KU</button>
    </div>
    
    <div class="product-images">
        <img src="https://i.ebayimg.com/images/g/zRoAAOSwJrBoEOUJ/s-l400.jpg" alt="مروحة لون أبيض">
        <img src="https://m.media-amazon.com/images/I/61fH4+bneaL._AC_UF350,350_QL80_.jpg" alt="مروحة لون أزرق">
    </div>
    
    <div class="form-container">
        <h1 data-translate="form_title">طلب شراء مروحة</h1>
        
        <div class="product-info">
            <p><strong data-translate="unit_price_label">سعر القطعة الواحدة:</strong> <span data-translate="unit_price">15,000 دينار عراقي</span></p>
            <p><strong data-translate="delivery_label">التوصيل:</strong> <span data-translate="delivery_free">مجاني لجميع المحافظات</span></p>
        </div>
        
        <form id="orderForm">
            <div class="form-group">
                <label for="name" data-translate="full_name_label">الاسم بالكامل *</label>
                <input type="text" id="name" name="name" required data-translate="full_name_placeholder" placeholder="أدخل اسمك الكامل">
            </div>
            
            <!-- حقل العنوان مع زر الحصول على الموقع -->
            <div class="form-group">
                <label for="address" data-translate="address_label">العنوان التفصيلي *</label>
                <div class="address-group">
                    <textarea id="address" name="address" rows="3" required data-translate="address_placeholder" placeholder="شارع، منطقة، مدينة، محافظة"></textarea>
                    <button type="button" class="location-btn" id="locationBtn" data-translate="get_location">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z" fill="white"/>
                        </svg>
                        <span>الحصول على الموقع</span>
                    </button>
                </div>
                <!-- ملاحظة حول الحصول على الموقع -->
                <div class="location-note">
                    <strong data-translate="location_note_label">ملاحظة:</strong> 
                    <span data-translate="location_note">سوف يأتي مندوب شركة التوصيل الى هذا الموقع مباشرة.</span>
                </div>
                <div class="loading-indicator" id="locationLoading">
                    <div class="loading-spinner"></div>
                    <p data-translate="location_loading">جاري الحصول على الموقع...</p>
                </div>
            </div>
            
            <div class="form-group">
                <label for="phone1" data-translate="phone_label">رقم الهاتف *</label>
                <input type="tel" id="phone1" name="phone1" required data-translate="phone_placeholder" placeholder="07XXXXXXXX">
                <small class="phone-note" data-translate="phone_note">يجب أن يكون رقم الهاتف شغالاً 24 ساعة</small>
            </div>
            
            <div class="form-group">
                <label for="phone2" data-translate="additional_phone_label">رقم هاتف إضافي <span class="optional" data-translate="optional_text">(اختياري)</span></label>
                <input type="tel" id="phone2" name="phone2" data-translate="additional_phone_placeholder" placeholder="07XXXXXXXX">
            </div>
            
            <!-- حقل طريقة الدفع -->
            <div class="form-group">
                <label for="paymentMethod" data-translate="payment_method_label">طريقة الدفع *</label>
                <select id="paymentMethod" name="paymentMethod" required>
                    <option value="" disabled selected data-translate="payment_select">اختر طريقة الدفع</option>
                    <option value="cash_on_delivery" data-translate="payment_cash">الدفع عند الاستلام</option>
                </select>
                
                <!-- ملاحظة خاصة بالدفع عند الاستلام -->
                <div class="payment-note">
                    <strong data-translate="note_label">ملاحظة:</strong> <span data-translate="payment_note">يمكنك فحص المنتج(ات) أمام مندوب التوصيل قبل الدفع</span>
                </div>
            </div>
            
            <!-- حقل عدد القطع لكل لون مع أزرار الزيادة والنقصان -->
            <div class="form-group">
                <label data-translate="color_quantity_label">عدد القطع لكل لون *</label>
                <div class="color-quantities">
                    <div class="color-quantity">
                        <div class="color-preview" style="background-color: #2575fc;"></div>
                        <span class="color-name" data-translate="blue_color">أزرق</span>
                        <div class="quantity-control">
                            <button type="button" class="quantity-btn" onclick="decrementQuantity('blueQuantity')">-</button>
                            <input type="number" id="blueQuantity" class="quantity-input" min="0" value="0" onchange="calculatePrice()">
                            <button type="button" class="quantity-btn" onclick="incrementQuantity('blueQuantity')">+</button>
                        </div>
                    </div>
                    <div class="color-quantity">
                        <div class="color-preview" style="background-color: #ffffff; border: 1px solid #e0e6ed;"></div>
                        <span class="color-name" data-translate="white_color">أبيض</span>
                        <div class="quantity-control">
                            <button type="button" class="quantity-btn" onclick="decrementQuantity('whiteQuantity')">-</button>
                            <input type="number" id="whiteQuantity" class="quantity-input" min="0" value="0" onchange="calculatePrice()">
                            <button type="button" class="quantity-btn" onclick="incrementQuantity('whiteQuantity')">+</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="price-summary">
                <div data-translate="total_price_label">السعر الإجمالي</div>
                <div class="total-price" id="totalPrice">0 دينار عراقي</div>
                <div data-translate="for_label">لـ <span id="quantityDisplay">0</span> <span data-translate="pieces_label">قطع</span></div>
                <div id="discountNotice" class="discount-notice" style="display:none" data-translate="discount_message">خصم خاص للكمية لأكثر من 2 قطع!</div>
            </div>
            
            <!-- ملاحظة إرسال نسخة للزبون -->
            <div class="customer-message-note">
                <strong data-translate="customer_note_label">ملاحظة:</strong> 
                <span data-translate="customer_note">سيتم إرسال نسخة من الطلب إلى رقم هاتفك الأساسي على واتساب</span>
            </div>
            
            <button type="button" class="submit-btn" onclick="sendToWhatsApp()">
                <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="واتساب" class="whatsapp-icon">
                <span data-translate="submit_button">إرسال الطلب عبر واتساب</span>
            </button>
        </form>
    </div>

    <footer class="footer">
        <p class="company-name-footer" data-translate="company_name">شركة الرياح للتسوق الإلكتروني</p>
        <p data-translate="copyright">جميع الحقوق محفوظة © <span id="currentYear"></span></p>
        <p><span data-translate="inquiries">للاستفسارات:</span> <span dir="ltr">+9647778610036</span></p>
    </footer>

    <script>
        // الأسعار
        const FIRST_UNIT_PRICE = 15000;
        const ADDITIONAL_UNIT_PRICE = 10000;
        
        // اللغة الحالية
        let currentLanguage = 'ar';
        
        // تخزين إحداثيات الموقع
        let userLocation = {
            latitude: null,
            longitude: null,
            address: null
        };
        
        // ترجمات النصوص
        const translations = {
            ar: {
                company_name: "شركة الرياح للتسوق الإلكتروني",
                form_title: "طلب شراء مروحة",
                unit_price_label: "سعر القطعة الواحدة:",
                unit_price: "15,000 دينار عراقي",
                additional_price_label: "سعر القطع الإضافية (2+):",
                additional_price: "10,000  دينار للقطعة",
                delivery_label: "التوصيل:",
                delivery_free: "مجاني لجميع المحافظات",
                full_name_label: "الاسم بالكامل *",
                full_name_placeholder: "أدخل اسمك الكامل",
                address_label: "العنوان التفصيلي *",
                address_placeholder: "شارع، منطقة، مدينة، محافظة",
                phone_label: "رقم الهاتف *",
                phone_placeholder: "07XXXXXXXX",
                phone_note: "يجب أن يكون رقم الهاتف شغالاً 24 ساعة",
                additional_phone_label: "رقم هاتف إضافي",
                additional_phone_placeholder: "07XXXXXXXX",
                optional_text: "(اختياري)",
                payment_method_label: "طريقة الدفع *",
                payment_select: "اختر طريقة الدفع",
                payment_cash: "الدفع عند الاستلام",
                note_label: "ملاحظة:",
                payment_note: "يمكنك فحص المنتج(ات) أمام مندوب التوصيل قبل الدفع",
                color_quantity_label: "عدد القطع لكل لون *",
                blue_color: "أزرق",
                white_color: "أبيض",
                total_price_label: "السعر الإجمالي",
                for_label: "لـ",
                pieces_label: "قطع",
                discount_message: "خصم خاص للكمية!",
                submit_button: "إرسال الطلب عبر واتساب",
                copyright: "جميع الحقوق محفوظة © 2025",
                inquiries: "للاستفسارات:",
                customer_note_label: "ملاحظة:",
                customer_note: "سيتم إرسال نسخة من الطلب إلى رقم هاتفك الأساسي على واتساب",
                get_location: "الحصول على الموقع",
                location_note_label: "ملاحظة:",
                location_note: "سوف يأتي مندوب شركة التوصيل الى هذا الموقع مباشرة.",
                location_loading: "جاري الحصول على الموقع...",
                location_success: "تم الحصول على موقعك بنجاح!",
                location_error: "حدث خطأ في الحصول على الموقع. الرجاء التأكد من تفعيل خدمات الموقع أو إدخال العنوان يدويًا.",
                map_link_label: "رابط الخريطة"
            },
            en: {
                company_name: "Al-Riyah E-commerce Company",
                form_title: "Fan Purchase Request",
                unit_price_label: "Price per unit:",
                unit_price: "15,000 IQD Iraqi",
                additional_price_label: "Additional units (2+):",
                additional_price: "10,000 IQD per unit",
                delivery_label: "Delivery:",
                delivery_free: "Free for all provinces",
                full_name_label: "Full Name *",
                full_name_placeholder: "Enter your full name",
                address_label: "Detailed Address *",
                address_placeholder: "Street, Area, City, Province",
                phone_label: "Phone Number *",
                phone_placeholder: "07XXXXXXXX",
                phone_note: "Phone must be active 24 hours",
                additional_phone_label: "Additional Phone",
                additional_phone_placeholder: "07XXXXXXXX",
                optional_text: "(optional)",
                payment_method_label: "Payment Method *",
                payment_select: "Select payment method",
                payment_cash: "Cash on Delivery",
                note_label: "Note:",
                payment_note: "You can inspect the product(s) before payment",
                color_quantity_label: "Quantity per Color *",
                blue_color: "Blue",
                white_color: "White",
                total_price_label: "Total Price",
                for_label: "For",
                pieces_label: "pieces",
                discount_message: "Special quantity discount for 2 pieaces!",
                submit_button: "Send Order via WhatsApp",
                copyright: "All rights reserved © 2025",
                inquiries: "For inquiries:",
                customer_note_label: "Note:",
                customer_note: "A copy of your order will be sent to your primary phone number via WhatsApp",
                get_location: "Get Location",
                location_note_label: "Note:",
                location_note: "A delivery company representative will come directly to this location.",
                location_loading: "Getting your location...",
                location_success: "Location retrieved successfully!",
                location_error: "Error getting location. Please ensure location services are enabled or enter address manually.",
                map_link_label: "Map Link"
            },
            ku: {
                company_name: "Şirketa Al-Riyah ji bo Kirînên Elektronîkî",
                form_title: "Daxwaza Kirina Pankê",
                unit_price_label: "Bihayê yekîneyê:",
                unit_price: "15,000 Dînar",
                additional_price_label: "Yekîneyên zêde (2+):",
                additional_price: "10,000 Dînar ji bo her yekîneyê",
                delivery_label: "Radestkirin:",
                delivery_free: "Ji bo hemû parêzgehan belaş",
                full_name_label: "Navê Temam *",
                full_name_placeholder: "Navê te yê temam binivîse",
                address_label: "Navnîşana Detayî *",
                address_placeholder: "Kole, Herêm, Bajar, Parêzgeh",
                phone_label: "Hejmara Telefonê *",
                phone_placeholder: "07XXXXXXXX",
                phone_note: "Divê telefon 24 saet çalak be",
                additional_phone_label: "Telefona Zêde",
                additional_phone_placeholder: "07XXXXXXXX",
                optional_text: "(bijarte)",
                payment_method_label: "Rêbaza Peredanê *",
                payment_select: "Rêbaza peredanê hilbijêre",
                payment_cash: "Peredana li ser radestkirinê",
                note_label: "Not:",
                payment_note: "Hûn dikarin berî peredanê hilber(an) kontrol bikin",
                color_quantity_label: "Hejmara ji bo her Rengî *",
                blue_color: "Şîn",
                white_color: "Spî",
                total_price_label: "Bihayê Giştî",
                for_label: "Ji bo",
                pieces_label: "parçe",
                discount_message: "Kêmasiya taybet ji bo hejmara zêde!",
                submit_button: "Daxwaz bi WhatsAppê bişîne",
                copyright: "Hemû maf parastî ne © 2025",
                inquiries: "Ji bo pirsan:",
                customer_note_label: "Not:",
                customer_note: "Kopyeyek ji daxwaza we dê ji hejmara telefonê weya sereke re bi WhatsAppê were şandin",
                get_location: "Cîhê Bigire",
                location_note_label: "Not:",
                location_note: " Nûnerê şîrketa radestkirinê dê rasterast were vê derê.",
                location_loading: "Cîhê we tê standin...",
                location_success: "Cîh bi serkeftî hat girtin!",
                location_error: "Di wergirtina cîhê de çewtî çêbû. Ji kerema xwe piştrast bikin ku karûbarên cîhê çalak in an navnîşana bi destan binivîse.",
                map_link_label: "Lînka Nexşeyê"
            }
        };
        
        // تغيير اللغة
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // تحديث أزرار اللغة
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.lang-btn.${lang}`).classList.add('active');
            
            // تحديث اتجاه الصفحة
            const htmlElement = document.getElementById('htmlElement');
            htmlElement.dir = lang === 'en' ? 'ltr' : 'rtl';
            htmlElement.lang = lang;
            
            // تحديث النصوص
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang][key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = translations[lang][key];
                    } else if (element.tagName === 'OPTION' && element.value === "") {
                        element.textContent = translations[lang][key];
                    } else if (element.id === 'locationBtn') {
                        element.querySelector('span').textContent = translations[lang][key];
                    } else {
                        element.textContent = translations[lang][key];
                    }
                }
            });
            
            // تحديث السعر
            calculatePrice();
        }
        
        // زيادة الكمية
        function incrementQuantity(inputId) {
            const input = document.getElementById(inputId);
            let value = parseInt(input.value) || 0;
            input.value = value + 1;
            calculatePrice();
        }
        
        // نقصان الكمية
        function decrementQuantity(inputId) {
            const input = document.getElementById(inputId);
            let value = parseInt(input.value) || 0;
            if (value > 0) {
                input.value = value - 1;
                calculatePrice();
            }
        }
        
        // حساب السعر
        function calculatePrice() {
            // الحصول على عدد القطع لكل لون
            const blueQty = parseInt(document.getElementById('blueQuantity').value) || 0;
            const whiteQty = parseInt(document.getElementById('whiteQuantity').value) || 0;
            
            // حساب العدد الكلي للقطع
            const totalQty = blueQty + whiteQty;
            
            let totalPrice = 0;
            let showDiscount = false;
            
            if (totalQty > 0) {
                // حساب السعر بناءً على سياسة التسعير
                totalPrice = FIRST_UNIT_PRICE + (ADDITIONAL_UNIT_PRICE * (totalQty - 1));
                showDiscount = totalQty > 1;
            }
            
            // تحديث عرض السعر بناءً على اللغة
            let currency = ' دينار';
            if (currentLanguage === 'en') currency = ' IQD';
            if (currentLanguage === 'ku') currency = ' Dînar';
            
            document.getElementById('totalPrice').textContent = totalPrice.toLocaleString() + currency;
            document.getElementById('quantityDisplay').textContent = totalQty;
            
            const discountNotice = document.getElementById('discountNotice');
            if (showDiscount) {
                discountNotice.style.display = 'block';
            } else {
                discountNotice.style.display = 'none';
            }
        }
        
        // الحصول على الموقع التلقائي
        function getLocation() {
            const locationBtn = document.getElementById('locationBtn');
            const addressField = document.getElementById('address');
            const loadingIndicator = document.getElementById('locationLoading');
            
            // إظهار مؤشر التحميل
            loadingIndicator.style.display = 'block';
            locationBtn.disabled = true;
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    // نجاح الحصول على الموقع
                    function(position) {
                        userLocation.latitude = position.coords.latitude;
                        userLocation.longitude = position.coords.longitude;
                        
                        // استخدام خدمة Nominatim لتحويل الإحداثيات إلى عنوان
                        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${userLocation.latitude}&lon=${userLocation.longitude}&zoom=18&addressdetails=1&accept-language=${currentLanguage}`)
                            .then(response => response.json())
                            .then(data => {
                                if (data && data.display_name) {
                                    // تحديث حقل العنوان بالموقع الجديد
                                    addressField.value = data.display_name;
                                    userLocation.address = data.display_name;
                                    
                                    // إظهار رسالة نجاح
                                    loadingIndicator.innerHTML = `<p style="color: var(--price-color);">${translations[currentLanguage].location_success}</p>`;
                                    setTimeout(() => {
                                        loadingIndicator.style.display = 'none';
                                    }, 2000);
                                } else {
                                    showLocationError();
                                }
                            })
                            .catch(() => {
                                showLocationError();
                            });
                    },
                    // خطأ في الحصول على الموقع
                    function(error) {
                        showLocationError();
                    }
                );
            } else {
                showLocationError();
            }
        }
        
        // عرض رسالة خطأ عند فشل الحصول على الموقع
        function showLocationError() {
            const loadingIndicator = document.getElementById('locationLoading');
            loadingIndicator.innerHTML = `<p style="color: var(--discount-color);">${translations[currentLanguage].location_error}</p>`;
            
            // إعادة تفعيل الزر بعد فترة
            setTimeout(() => {
                loadingIndicator.style.display = 'none';
                document.getElementById('locationBtn').disabled = false;
            }, 3000);
        }
        
        // إنشاء رابط الخريطة
        function createMapLink(latitude, longitude) {
            return `https://www.google.com/maps?q=${latitude},${longitude}`;
        }
        
        // إرسال الطلب عبر واتساب
        function sendToWhatsApp() {
            const name = document.getElementById('name').value;
            const address = document.getElementById('address').value;
            const phone1 = document.getElementById('phone1').value;
            const phone2 = document.getElementById('phone2').value;
            const paymentMethod = document.getElementById('paymentMethod').value;
            const blueQty = parseInt(document.getElementById('blueQuantity').value) || 0;
            const whiteQty = parseInt(document.getElementById('whiteQuantity').value) || 0;
            const totalQty = blueQty + whiteQty;
            
            // التحقق من الحقول المطلوبة
            if (!name || !address || !phone1 || totalQty === 0 || !paymentMethod) {
                let alertMessage = "الرجاء تعبئة جميع الحقول المطلوبة";
                if (currentLanguage === 'en') alertMessage = "Please fill in all required fields";
                if (currentLanguage === 'ku') alertMessage = "Ji kerema xwe hemî zeviyên pêwîst dagirin";
                alert(alertMessage);
                return;
            }
            
            // حساب السعر النهائي
            let totalPrice = 0;
            if (totalQty > 0) {
                totalPrice = FIRST_UNIT_PRICE + (ADDITIONAL_UNIT_PRICE * (totalQty - 1));
            }
            
            // بناء رسالة الواتساب بناءً على اللغة
            let message = '';
            let currency = ' دينار';
            let blueColor = 'أزرق';
            let whiteColor = 'أبيض';
            let paymentMethodText = 'الدفع عند الاستلام';
            let mapLinkLabel = 'رابط الخريطة';
            
            if (currentLanguage === 'en') {
                currency = ' IQD';
                blueColor = 'Blue';
                whiteColor = 'White';
                paymentMethodText = 'Cash on Delivery';
                mapLinkLabel = 'Map Link';
                
                message = `Hello,\n\nI would like to purchase a fan from Al-Riyah E-commerce Company. Details are as follows:\n- Name: ${name}\n- Address: ${address}\n- Phone: ${phone1}`;
                
                if (phone2) {
                    message += `\n- Additional Phone: ${phone2}`;
                }
                
                message += `\n- Payment Method: ${paymentMethodText}\n- Blue Quantity: ${blueQty}\n- White Quantity: ${whiteQty}\n- Total Price: ${totalPrice.toLocaleString()}${currency}`;
                
                // إضافة رابط الخريطة إذا كان متوفرًا
                if (userLocation.latitude && userLocation.longitude) {
                    const mapLink = createMapLink(userLocation.latitude, userLocation.longitude);
                    message += `\n- ${mapLinkLabel}: ${mapLink}`;
                }
                
                if (totalQty > 1) {
                    message += `\n  (The order will be delivered within 48 hours...)`;
                }
                
                message += `\n\nYour order will be delivered within 48 hours.Thank you!`;
                
            } else if (currentLanguage === 'ku') {
                currency = ' Dînar';
                blueColor = 'Şîn';
                whiteColor = 'Spî';
                paymentMethodText = 'Peredana li ser radestkirinê';
                mapLinkLabel = 'Lînka Nexşeyê';
                
                message = `Silav,\n\nEz dixwazim ji Şirketa Al-Riyah ji bo Kirînên Elektronîkî pankek bikirim. Detay wiha ne:\n- Nav: ${name}\n- Navnîşan: ${address}\n- Telefon: ${phone1}`;
                
                if (phone2) {
                    message += `\n- Telefona Zêde: ${phone2}`;
                }
                
                message += `\n- Rêbaza Peredanê: ${paymentMethodText}\n- Hejmara Şîn: ${blueQty}\n- Hejmara Spî: ${whiteQty}\n- Bihayê Giştî: ${totalPrice.toLocaleString()}${currency}`;
                
                // إضافة رابط الخريطة إذا كان متوفرًا
                if (userLocation.latitude && userLocation.longitude) {
                    const mapLink = createMapLink(userLocation.latitude, userLocation.longitude);
                    message += `\n- ${mapLinkLabel}: ${mapLink}`;
                }
                
                if (totalQty > 1) {
                    message += `\n  (Ferman dê di nav 48 demjimêran de were radestkirin...)`;
                }
                
                message += `\n\nSiparîşa we dê di nav 48 demjimêran de were radest kirin.Spas dikim!`;
                
            } else { // اللغة العربية
                mapLinkLabel = 'رابط الخريطة';
                
                message = `السلام عليكم،\n\nأرغب بشراء مروحة من شركة الرياح للتسوق الإلكتروني، والتفاصيل كالتالي:\n- الاسم: ${name}\n- العنوان: ${address}\n- رقم الهاتف: ${phone1}`;
                
                if (phone2) {
                    message += `\n- رقم هاتف إضافي: ${phone2}`;
                }
                
                message += `\n- طريقة الدفع: ${paymentMethodText}\n- عدد القطع الزرقاء: ${blueQty}\n- عدد القطع البيضاء: ${whiteQty}\n- السعر الإجمالي: ${totalPrice.toLocaleString()}${currency}`;
                
                // إضافة رابط الخريطة إذا كان متوفرًا
                if (userLocation.latitude && userLocation.longitude) {
                    const mapLink = createMapLink(userLocation.latitude, userLocation.longitude);
                    message += `\n- ${mapLinkLabel}: ${mapLink}`;
                }
                
                if (totalQty > 1) {
                    message += `\n  (سيتم توصيل الطلب خلال48 ساعة...)`;
                }
                
                message += `\n\n سوف يتم ايصال طلبك خلال48 ساعة.وشكرًا!`;
            }
            
            const whatsappNumber = "9647778610036"; // رقم الشركة على واتساب
            
            // ترميز الرسالة للرابط
            const encodedMessage = encodeURIComponent(message);
            
            // إنشاء رابطين: واحد للشركة وآخر للزبون
            const companyWhatsappLink = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            const customerWhatsappLink = `https://wa.me/${phone1}?text=${encodedMessage}`;
            
            // فتح رابط الشركة في نافذة جديدة
            window.open(companyWhatsappLink, '_blank');
            
            // فتح رابط الزبون في نافذة جديدة بعد تأخير بسيط
            setTimeout(() => {
                window.open(customerWhatsappLink, '_blank');
            }, 500);
            
            // عرض رسالة تأكيد
            let successMessage = "تم إرسال طلبك بنجاح! سيصلك تأكيد على واتساب.";
            if (currentLanguage === 'en') successMessage = "Your order has been sent successfully! You will receive a confirmation on WhatsApp.";
            if (currentLanguage === 'ku') successMessage = "Daxwaza we bi serkeftî hate şandin! We dê pejirandinek li ser WhatsAppê werbigirin.";
            
            alert(successMessage);
        }
        
        // حساب السعر عند تحميل الصفحة
        window.onload = function() {
            calculatePrice();
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // إضافة مستمع حدث لزر الحصول على الموقع
            document.getElementById('locationBtn').addEventListener('click', getLocation);
        };
    </script>
</body>
</html>
